
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.statamcp.com/mcp/tools/">
      
      
        <link rel="prev" href="../../monitoring/">
      
      
        <link rel="next" href="../resources/">
      
      
        
      
      
      <link rel="icon" href="https://r2.statamcp.com/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Tools - Stata-MCP Documents</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mcptools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Stata-MCP Documents" class="md-header__button md-logo" aria-label="Stata-MCP Documents" data-md-component="logo">
      
  <img src="https://example-data.statamcp.com/android-chrome-512x512.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Stata-MCP Documents
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tools
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sepinetam/stata-mcp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    stata-mcp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Stata-MCP Documents" class="md-nav__button md-logo" aria-label="Stata-MCP Documents" data-md-component="logo">
      
  <img src="https://example-data.statamcp.com/android-chrome-512x512.png" alt="logo">

    </a>
    Stata-MCP Documents
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sepinetam/stata-mcp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    stata-mcp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../claude-plugin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Claude Plugin
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../clients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clients
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get_data_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_data_info
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stata_do" class="md-nav__link">
    <span class="md-ellipsis">
      
        stata_do
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write_dofile" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_dofile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#append_dofile" class="md-nav__link">
    <span class="md-ellipsis">
      
        append_dofile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mk_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        mk_dir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load_figure" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_figure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_file
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ado_package_install" class="md-nav__link">
    <span class="md-ellipsis">
      
        ado_package_install
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    <span class="md-ellipsis">
      
        help
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resources
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Summary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/claude_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Claude Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    CoreTech
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    CoreTech
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/stata/finder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stata Finder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/stata/do/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stata Runner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/stata/help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stata Help
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core/stata/package/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stata package
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get_data_info" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_data_info
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stata_do" class="md-nav__link">
    <span class="md-ellipsis">
      
        stata_do
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#write_dofile" class="md-nav__link">
    <span class="md-ellipsis">
      
        write_dofile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#append_dofile" class="md-nav__link">
    <span class="md-ellipsis">
      
        append_dofile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mk_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        mk_dir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load_figure" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_figure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_file
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ado_package_install" class="md-nav__link">
    <span class="md-ellipsis">
      
        ado_package_install
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help" class="md-nav__link">
    <span class="md-ellipsis">
      
        help
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="mcptools">MCP.Tools</h1>
<hr />
<h2 id="get_data_info">get_data_info</h2>
<pre><code class="language-python">def get_data_info(data_path: str | Path,
                  vars_list: List[str] | None = None,
                  encoding: str = &quot;utf-8&quot;) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>data_path</code>: Absolute filesystem path or URL to data file (required)
- <code>vars_list</code>: Optional variable subset specification for selective analysis (default: null, all variables)
- <code>encoding</code>: Character encoding for text-based formats (default: UTF-8, ignored for .dta)</p>
<p><strong>Return Structure</strong>:
Serialized JSON string containing multi-layered metadata:</p>
<pre><code class="language-json">{
  &quot;overview&quot;: {&quot;source&quot;: &lt;path&gt;, &quot;obs&quot;: &lt;int&gt;, &quot;var_numbers&quot;: &lt;int&gt;, &quot;var_list&quot;: [&lt;array&gt;]},
  &quot;info_config&quot;: {&quot;metrics&quot;: [&lt;array&gt;], &quot;max_display&quot;: &lt;int&gt;, &quot;decimal_places&quot;: &lt;int&gt;},
  &quot;vars_detail&quot;: {&lt;variable_name&gt;: {&quot;var&quot;: &lt;str&gt;, &quot;type&quot;: &lt;str&gt;, &quot;summary&quot;: {...}}},
  &quot;saved_path&quot;: &lt;cache_file_path&gt;
}
</code></pre>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Local file analysis
get_data_info(&quot;/data/econometrics/survey.dta&quot;)
get_data_info(&quot;~/Documents/exports/quarterly.csv&quot;, vars_list=[&quot;gdp&quot;, &quot;inflation&quot;, &quot;unemployment&quot;])

# Remote data ingestion
get_data_info(&quot;https://repository.org/datasets/panel_data.xlsx&quot;)

# Encoded source handling
get_data_info(&quot;/data/legacy/latin1_data.csv&quot;, encoding=&quot;latin1&quot;)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool operates through a multi-layered abstraction cascade. At the foundation lies a polymorphic class hierarchy where <code>DataInfoBase</code> defines the abstract interface for format-specific handlers (<code>DtaDataInfo</code>, <code>CsvDataInfo</code>, <code>ExcelDataInfo</code>). Content integrity verification employs MD5 hashing with configurable suffix length for cache identification. Configuration propagation follows a precedence chain: runtime parameters override environment variables (<code>STATA_MCP_DATA_INFO_DECIMAL_PLACES</code>, <code>STATA_MCP_DATA_INFO_STRING_KEEP_NUMBER</code>), which in turn override TOML-based configuration at <code>~/.statamcp/config.toml</code>.</p>
<p>Statistical computation leverages pandas DataFrame operations with NumPy backend. The metrics system implements a configurable computation pipeline where default metrics (<code>obs</code>, <code>mean</code>, <code>stderr</code>, <code>min</code>, <code>max</code>) can be extended through configuration to include quartiles (<code>q1</code>, <code>q3</code>) and distribution shape measures (<code>skewness</code>, <code>kurtosis</code>). Type dispatch separates string variables (observation counting with unique value sampling under <code>max_display</code> threshold) from numeric variables (central tendency, dispersion, and distribution shape computation with <code>decimal_places</code> precision rounding).</p>
<p>Caching strategy employs content-addressable storage where hash computation determines cache file naming: <code>data_info__&lt;name&gt;_&lt;ext&gt;__hash_&lt;suffix&gt;.json</code>. Cache resolution occurs at invocation time, with automatic regeneration on content hash divergence. The cache directory defaults to <code>~/.statamcp/.cache/</code> but can be overridden to project-specific <code>stata-mcp-tmp/</code> locations through the <code>cache_dir</code> parameter.</p>
<hr />
<h2 id="stata_do">stata_do</h2>
<pre><code class="language-python">def stata_do(dofile_path: str,
             log_file_name: str | None = None,
             is_read_log: bool = True) -&gt; Dict[str, Union[str, None]]:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>dofile_path</code>: Absolute or relative path to target .do file (required)
- <code>log_file_name</code>: Custom log filename without timestamp (optional, auto-generated if null)
- <code>is_read_log</code>: Boolean flag for log content retrieval (default: true)</p>
<p><strong>Return Structure</strong>:
Dictionary containing execution metadata and optional log payload:</p>
<pre><code class="language-python">{
  &quot;log_file_path&quot;: &quot;&lt;absolute_path_to_stata_log&gt;&quot;,
  &quot;log_content&quot;: &quot;&lt;full_log_text_or_'Not_read_log'&gt;&quot;
}
</code></pre>
<p>Error condition returns: <code>{"error": "&lt;exception_message&gt;"}</code></p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Standard execution with log retrieval
stata_do(&quot;/Users/project/stata-mcp-dofile/20250104153045.do&quot;)

# Custom log naming
stata_do(&quot;~/analysis/regression_pipeline.do&quot;, log_file_name=&quot;quarterly_results&quot;)

# Execution without log reading
stata_do(&quot;/tmp/estimation.do&quot;, is_read_log=False)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool encapsulates the <code>StataDo</code> executor class which implements platform-specific command invocation strategies. Cross-platform abstraction abstracts Stata executable location through the <code>StataFinder</code> class: macOS probes <code>/Applications/Stata/</code> hierarchy, Windows interrogates Program Files registry, and Linux queries system PATH for <code>stata-mp</code>. The execution pipeline involves do-file staging, Stata CLI invocation with <code>-b</code> batch mode flag, log file redirection, and exit code monitoring.</p>
<p>Log file management operates within the <code>stata-mcp-log/</code> directory structure with automatic timestamp generation when <code>log_file_name</code> is omitted. The executor implements differential log handling based on <code>is_read_log</code> flag: when enabled, performs file read operation and returns content; when disabled, returns placeholder string to minimize I/O overhead.</p>
<p>Exception handling categorizes failures into three tiers: <code>FileNotFoundError</code> for missing do-file artifacts, <code>RuntimeError</code> for Stata execution failures or log generation issues, and <code>PermissionError</code> for insufficient execution or write permissions. Error conditions return dictionary with <code>"error"</code> key rather than raising exceptions to maintain MCP protocol compatibility.</p>
<hr />
<h2 id="write_dofile">write_dofile</h2>
<pre><code class="language-python">def write_dofile(content: str, 
                 encoding: str | None = None) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>content</code>: Stata command sequence to persist (required)
- <code>encoding</code>: Character encoding for file output (optional, defaults to UTF-8)</p>
<p><strong>Return Structure</strong>:
String containing absolute POSIX-compliant path to generated do-file</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Basic regression analysis
write_dofile(&quot;&quot;&quot;
use &quot;/data/survey.dta&quot;, clear
regress income age education experience
outreg2 using &quot;`output_path'/results.doc&quot;, replace
&quot;&quot;&quot;)

# Time series analysis with encoding specification
write_dofile(&quot;&quot;&quot;
tsset date
arima gdp, ar(1) ma(1)
predict forecast
&quot;&quot;&quot;, encoding=&quot;latin1&quot;)

# Data transformation pipeline
write_dofile(&quot;&quot;&quot;
gen log_gdp = ln(gdp)
gen diff_income = d(income)
xtset country_id year
xtreg diff_income log_gdp, fe
&quot;&quot;&quot;)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements atomic file creation within the <code>stata-mcp-dofile/</code> directory hierarchy. File naming employs ISO 8601 basic format timestamp generation (<code>YYYYMMDDHHMMSS.do</code>) ensuring temporal uniqueness and chronological sorting. The write operation utilizes Python's built-in <code>open()</code> function with mode <code>"w"</code> and specified encoding parameter, performing implicit file creation and truncation for atomic write semantics.</p>
<p>Integration with output redirection commands (<code>outreg2</code>, <code>esttab</code>) requires coordination with the <code>results_doc_path</code> prompt to establish output directory paths prior to do-file generation. This separation of concerns enables deterministic output path management across multiple Stata execution cycles.</p>
<p>The tool does not perform syntactic validation or semantic analysis of the Stata code content. Code correctness, command sequencing, and macro expansion validity remain the responsibility of the calling context. Error handling wraps file I/O operations in try-except blocks with structured logging for success/failure tracking.</p>
<hr />
<h2 id="append_dofile">append_dofile</h2>
<pre><code class="language-python">def append_dofile(original_dofile_path: str,
                  content: str,
                  encoding: str | None = None) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>original_dofile_path</code>: Source file path for content extension (may be invalid or empty)
- <code>content</code>: Stata code to append (required)
- <code>encoding</code>: Character encoding (optional, defaults to UTF-8)</p>
<p><strong>Return Structure</strong>:
String containing absolute path to new do-file (either modified copy or newly created artifact)</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Extend existing analysis
append_dofile(
    &quot;/Users/project/stata-mcp-dofile/base_analysis.do&quot;,
    &quot;xtreg y x1 x2, fe robust&quot;
)

# Fail-safe creation when source missing
append_dofile(
    &quot;/nonexistent/path.do&quot;,
    &quot;regress y x&quot;
)
# Returns new file path with provided content

# Code composition for iterative analysis
append_dofile(
    previous_dofile_path,
    &quot;&quot;&quot;
predict residuals, residuals
summarize residuals
&quot;&quot;&quot;
)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements a fail-safe composition strategy through three-phase operation: validation phase checks <code>original_dofile_path</code> existence and accessibility via <code>Path.exists()</code> probe; composition phase performs conditional content assembly where valid source files trigger read operations followed by concatenation, while invalid paths trigger new file creation; persistence phase writes combined content to a new timestamped artifact in <code>stata-mcp-dofile/</code> hierarchy.</p>
<p>Critical design characteristic: source files remain unmodified. All composition operations create new artifacts with fresh timestamps, ensuring source immutability and preserving provenance. Newline integrity maintenance examines source file termination; if source content lacks trailing newline, separator insertion occurs before content append.</p>
<p>The tool does not perform syntactic coherence validation between original and appended content. Macro variable scoping, temporary variable naming conflicts, and command sequence validity require manual coordination by the caller. Similar to <code>write_dofile</code>, output redirection path management necessitates prior <code>results_doc_path</code> invocation for commands requiring explicit output file specification.</p>
<p>Platform-specific path resolution utilizes <code>pathlib.Path</code> for cross-platform compatibility. File read operations employ specified encoding parameter with fallback to UTF-8 default. Error handling wraps I/O operations with silent failure on read errors, treating read exceptions equivalent to missing source files.</p>
<hr />
<h2 id="mk_dir">mk_dir</h2>
<pre><code class="language-python">def mk_dir(path: str) -&gt; bool:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>path</code>: Directory path specification (string, required, non-empty)</p>
<p><strong>Return Structure</strong>:
Boolean indicating directory existence verification post-creation (true: exists, false: creation failed)</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Single directory creation
mk_dir(&quot;/Users/project/outputs&quot;)
# Returns: True

# Recursive hierarchy creation
mk_dir(&quot;~/analysis/2025/q1/january&quot;)
# Creates: analysis/, analysis/2025/, analysis/2025/q1/, analysis/2025/q1/january/

# Cross-platform paths
mk_dir(&quot;C:\\Users\\project\\data&quot;)  # Windows
mk_dir(&quot;/home/user/analysis&quot;)       # Unix
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements secure directory creation through the <code>pathvalidate</code> library's <code>sanitize_filepath()</code> function with platform-specific validation. Sanitization phase removes directory traversal sequences, normalizes path separators, and validates character encoding. Path resolution converts sanitized input to absolute form via <code>Path.resolve()</code>, eliminating symbolic links and relative path components.</p>
<p>Directory creation employs <code>Path.mkdir()</code> with parameters <code>mode=0o755</code> (rwxr-xr-x: owner read/write/execute, group/others read/execute), <code>exist_ok=True</code> (idempotent operation), and <code>parents=True</code> (recursive creation). Permission configuration follows Unix filesystem conventions with read/execute for group and others enabling directory traversal and listing.</p>
<p>Exception hierarchy provides granular failure diagnostics: <code>ValueError</code> raised for invalid path detection via <code>ValidationError</code> from sanitization phase; <code>PermissionError</code> raised for insufficient directory creation permissions detected by OS; <code>OSError</code> raised for filesystem-level failures (disk full, quota exceeded, readonly filesystem). All exceptions propagate to caller with descriptive messages.</p>
<p>Post-creation verification performs boolean existence check via <code>Path.exists()</code> combined with <code>Path.is_dir()</code> to confirm successful directory creation and differentiate between directories and files with identical names.</p>
<hr />
<h2 id="load_figure">load_figure</h2>
<pre><code class="language-python">def load_figure(figure_path: str) -&gt; Image:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>figure_path</code>: Absolute path to image file (required)</p>
<p><strong>Return Structure</strong>:
FastMCP <code>Image</code> object containing image data for MCP transport and display</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Load Stata-generated graph
load_figure(&quot;/Users/project/exports/regression_results.png&quot;)

# Load exported figure
load_figure(&quot;~/analysis/timeseries_plot.jpg&quot;)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements image asset loading from the local filesystem using FastMCP's native <code>Image</code> class wrapper. Path validation checks file existence via <code>Path.exists()</code> probe; missing assets trigger <code>FileNotFoundError</code> exception with descriptive message. Successful invocations construct <code>Image</code> object with file path as initialization parameter, enabling automatic file reading and MIME type detection by the underlying MCP framework.</p>
<p>Supported formats depend on FastMCP implementation but typically include PNG (Portable Network Graphics) and JPEG (Joint Photographic Experts Group). The tool performs no format validation or conversion; unsupported formats generate errors during Image object construction or transport phase.</p>
<p>Error logging writes structured messages to logging infrastructure prior to exception propagation, enabling audit trail of failed load attempts. The tool performs no image processing, resizing, or format conversion—operations occur at display/rendering time by the MCP client application.</p>
<hr />
<h2 id="read_file">read_file</h2>
<pre><code class="language-python">def read_file(file_path: str, 
              encoding: str = &quot;utf-8&quot;) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>file_path</code>: Absolute path to target file (required)
- <code>encoding</code>: Character encoding for text decoding (optional, defaults to UTF-8)</p>
<p><strong>Return Structure</strong>:
String containing complete file content decoded with specified encoding</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Read Stata log file
read_file(&quot;/Users/project/stata-mcp-log/20250104153045.log&quot;)

# Read configuration with encoding
read_file(&quot;~/.statamcp/config.toml&quot;, encoding=&quot;utf-8&quot;)

# Read exported results
read_file(&quot;~/analysis/tables/regression_results.txt&quot;)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements generic file reading via Python's built-in <code>open()</code> function with mode <code>"r"</code> and specified encoding parameter. Path validation checks file existence through <code>Path.exists()</code>; missing files raise <code>FileNotFoundError</code> with descriptive message including invalid path. File reading utilizes context manager (<code>with</code> statement) for automatic file handle closure and resource cleanup.</p>
<p>Content reading performs single operation <code>file.read()</code> retrieving entire file content into memory as string. For large files exceeding available memory, this approach triggers <code>MemoryError</code>; however, typical use cases involve log files, configuration files, and result tables within reasonable size bounds.</p>
<p>Error handling categorizes failures: <code>FileNotFoundError</code> for non-existent paths, <code>IOError</code> for I/O operation failures (permission denied, disk read error, filesystem corruption), and <code>UnicodeDecodeError</code> for encoding mismatches (though not explicitly caught, propagates to caller with encoding information). Success operations log structured messages including file path for audit trail.</p>
<hr />
<h2 id="ado_package_install">ado_package_install</h2>
<pre><code class="language-python">def ado_package_install(package: str,
                        source: str = &quot;ssc&quot;,
                        is_replace: bool = True,
                        package_source_from: str | None = None) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>package</code>: Package identifier (required)
  - SSC: package name (e.g., "outreg2")
  - GitHub: "username/reponame" format (e.g., "sepinetam/texiv")
  - net: package name with <code>package_source_from</code> specifying source
- <code>source</code>: Distribution source (optional, default: "ssc")
  - Options: "ssc", "github", "net"
- <code>is_replace</code>: Force replacement flag (optional, default: true)
- <code>package_source_from</code>: Source URL or directory for 'net' installations (optional)</p>
<p><strong>Return Structure</strong>:
String containing complete Stata execution log from installation operation</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># SSC package installation
ado_package_install(&quot;outreg2&quot;, source=&quot;ssc&quot;)

# GitHub package installation
ado_package_install(&quot;sepinetam/texiv&quot;, source=&quot;github&quot;)

# Network installation
ado_package_install(&quot;custompkg&quot;, source=&quot;net&quot;, package_source_from=&quot;https://example.com/stata/&quot;)

# Force reinstall
ado_package_install(&quot;estout&quot;, source=&quot;ssc&quot;, is_replace=True)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements platform-divergent installation strategies. Unix systems (macOS/Linux) execute through specialized installer classes inheriting from base installer interface: <code>SSC_Install</code> invokes <code>ssc install &lt;package&gt;, replace</code> via Stata CLI; <code>GITHUB_Install</code> executes <code>github install &lt;username/reponame&gt;, replace</code>; <code>NET_Install</code> runs <code>net install &lt;package&gt; from(&lt;source&gt;), replace</code>. Windows systems bypass direct installation, instead generating temporary do-file via <code>write_dofile</code> and delegating to <code>stata_do</code> execution.</p>
<p>Installation verification occurs through message parsing where installer classes examine Stata output for success indicators. The <code>check_installed_from_msg()</code> method performs regex or substring matching to identify successful installation patterns. Failed installations trigger error logging with full message capture via debug-level logging.</p>
<p>Performance considerations advise against unnecessary invocations due to network latency, repository lookup overhead, and redundant installation attempts when packages already exist in Stata's ado directory. The tool implements no local installation cache—each invocation queries remote repositories or filesystem.</p>
<hr />
<h2 id="help">help</h2>
<blockquote>
<p>macOS and Linux only</p>
</blockquote>
<pre><code class="language-python">def help(cmd: str) -&gt; str:
    ...
</code></pre>
<p><strong>Input Parameters</strong>:
- <code>cmd</code>: Stata command name (required, e.g., "regress", "describe", "xtset")</p>
<p><strong>Return Structure</strong>:
String containing Stata help text output with optional cache status prefix (e.g., "Cached result for regress: ...")</p>
<p><strong>Operational Examples</strong>:</p>
<pre><code class="language-python"># Regression command help
help(&quot;regress&quot;)

# Panel data commands
help(&quot;xtset&quot;)
help(&quot;xtreg&quot;)

# Data management
help(&quot;merge&quot;)
help(&quot;reshape&quot;)
</code></pre>
<p><strong>Implementation Architecture</strong>:
The tool implements Stata command documentation retrieval through CLI invocation with caching layer. Documentation requests execute Stata in batch mode with <code>help &lt;cmd&gt;</code> command, capturing stdout for return value. The <code>StataHelp</code> class manages invocation through platform-specific Stata CLI paths detected by <code>StataFinder</code>.</p>
<p>Caching architecture maintains help text cache at <code>~/.statamcp/help/</code> directory with file-based storage keyed by command name. Cache behavior controllable via environment variables: <code>STATA_MCP_CACHE_HELP</code> (default: true) enables/disables caching; <code>STATA_MCP_SAVE_HELP</code> controls cache persistence. Cached results include prefix message indicating cache status: "Cached result for {cmd}: ..." versus live help text.</p>
<p>Dual decoration pattern registers tool as both MCP resource and executable function. Resource URI pattern <code>help://stata/{cmd}</code> enables URI-based access through MCP resource protocol, while function decorator <code>@stata_mcp.tool()</code> enables direct invocation. This dual registration provides flexible access patterns for different MCP client implementations.</p>
<p>Cache invalidation requires manual deletion of cache files or environment variable configuration; no TTL-based expiration exists. Help text language depends on Stata installation locale; multilingual support requires separate Stata installations or locale reconfiguration.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "content.code.select", "navigation.path", "navigation.sections", "navigation.expand", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>